<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: OmniAuth::LDAP::Adaptor
  
    &mdash; Documentation by YARD 0.9.37
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "OmniAuth::LDAP::Adaptor";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (A)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../OmniAuth.html" title="OmniAuth (module)">OmniAuth</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../LDAP.html" title="OmniAuth::LDAP (module)">LDAP</a></span></span>
     &raquo; 
    <span class="title">Adaptor</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: OmniAuth::LDAP::Adaptor
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">OmniAuth::LDAP::Adaptor</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/omniauth-ldap/adaptor.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p>Public API: <span class='object_link'><a href="#validate-class_method" title="OmniAuth::LDAP::Adaptor.validate (method)">Adaptor.validate</a></span>, <span class='object_link'><a href="#initialize-instance_method" title="OmniAuth::LDAP::Adaptor#initialize (method)">#initialize</a></span>, <span class='object_link'><a href="#bind_as-instance_method" title="OmniAuth::LDAP::Adaptor#bind_as (method)">#bind_as</a></span>, and attr readers such as <span class='object_link'><a href="#connection-instance_method" title="OmniAuth::LDAP::Adaptor#connection (method)">#connection</a></span>, <span class='object_link'><a href="#uid-instance_method" title="OmniAuth::LDAP::Adaptor#uid (method)">#uid</a></span></p>
</div>
  </div>

<p>Adaptor encapsulates the behavior required to connect to an LDAP server<br />
and perform searches and binds. It maps user-provided configuration into<br />
a Net::LDAP connection and provides compatibility helpers for different<br />
net-ldap and SASL versions. The adaptor is intentionally defensive and<br />
provides a small, stable API used by the OmniAuth strategy.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'><p>Initialize with minimal config</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_adaptor'>adaptor</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../OmniAuth.html" title="OmniAuth (module)">OmniAuth</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../LDAP.html" title="OmniAuth::LDAP (module)">LDAP</a></span></span><span class='op'>::</span><span class='const'>Adaptor</span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="OmniAuth::LDAP::Adaptor#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='label'>base:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>dc=example,dc=com</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>host:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ldap.example.com</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>


</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Adaptor/AuthenticationError.html" title="OmniAuth::LDAP::Adaptor::AuthenticationError (class)">AuthenticationError</a></span>, <span class='object_link'><a href="Adaptor/ConfigurationError.html" title="OmniAuth::LDAP::Adaptor::ConfigurationError (class)">ConfigurationError</a></span>, <span class='object_link'><a href="Adaptor/ConnectionError.html" title="OmniAuth::LDAP::Adaptor::ConnectionError (class)">ConnectionError</a></span>, <span class='object_link'><a href="Adaptor/LdapError.html" title="OmniAuth::LDAP::Adaptor::LdapError (class)">LdapError</a></span>
    
  
</p>

  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="VALID_ADAPTER_CONFIGURATION_KEYS-constant" class="">VALID_ADAPTER_CONFIGURATION_KEYS =
          <div class="docstring">
  <div class="discussion">
    <p>Valid configuration keys accepted by the adaptor. These correspond to<br />
the options supported by the gem and are used during initialization.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;Symbol&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
        </dt>
        <dd><pre class="code"><span class='lbracket'>[</span>
  <span class='symbol'>:hosts</span><span class='comma'>,</span>
  <span class='symbol'>:host</span><span class='comma'>,</span>
  <span class='symbol'>:port</span><span class='comma'>,</span>
  <span class='symbol'>:encryption</span><span class='comma'>,</span>
  <span class='symbol'>:disable_verify_certificates</span><span class='comma'>,</span>
  <span class='symbol'>:bind_dn</span><span class='comma'>,</span>
  <span class='symbol'>:password</span><span class='comma'>,</span>
  <span class='symbol'>:try_sasl</span><span class='comma'>,</span>
  <span class='symbol'>:sasl_mechanisms</span><span class='comma'>,</span>
  <span class='symbol'>:uid</span><span class='comma'>,</span>
  <span class='symbol'>:base</span><span class='comma'>,</span>
  <span class='symbol'>:allow_anonymous</span><span class='comma'>,</span>
  <span class='symbol'>:filter</span><span class='comma'>,</span>
  <span class='symbol'>:tls_options</span><span class='comma'>,</span>
  <span class='symbol'>:password_policy</span><span class='comma'>,</span>
  <span class='comment'># Timeouts
</span>  <span class='symbol'>:connect_timeout</span><span class='comma'>,</span>
  <span class='symbol'>:read_timeout</span><span class='comma'>,</span>

  <span class='comment'># Deprecated
</span>  <span class='symbol'>:method</span><span class='comma'>,</span>
  <span class='symbol'>:ca_file</span><span class='comma'>,</span>
  <span class='symbol'>:ssl_version</span><span class='comma'>,</span>
<span class='rbracket'>]</span></pre></dd>
      
        <dt id="MUST_HAVE_KEYS-constant" class="">MUST_HAVE_KEYS =
          <div class="docstring">
  <div class="discussion">
    <p>Required configuration keys. This may include alternatives as sub-lists<br />
(e.g., [:hosts, :host] means either key is acceptable).</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
        </dt>
        <dd><pre class="code"><span class='lbracket'>[</span>
  <span class='symbol'>:base</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='symbol'>:encryption</span><span class='comma'>,</span> <span class='symbol'>:method</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='comment'># :method is deprecated
</span>  <span class='lbracket'>[</span><span class='symbol'>:hosts</span><span class='comma'>,</span> <span class='symbol'>:host</span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='symbol'>:hosts</span><span class='comma'>,</span> <span class='symbol'>:port</span><span class='rbracket'>]</span><span class='comma'>,</span>
  <span class='lbracket'>[</span><span class='symbol'>:uid</span><span class='comma'>,</span> <span class='symbol'>:filter</span><span class='rbracket'>]</span><span class='comma'>,</span>
<span class='rbracket'>]</span></pre></dd>
      
        <dt id="ENCRYPTION_METHOD-constant" class="">ENCRYPTION_METHOD =
          <div class="docstring">
  <div class="discussion">
    <p>Supported encryption method mapping for configuration readability.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash&lt;Symbol,Symbol,nil&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span>
  <span class='label'>simple_tls:</span> <span class='symbol'>:simple_tls</span><span class='comma'>,</span>
  <span class='label'>start_tls:</span> <span class='symbol'>:start_tls</span><span class='comma'>,</span>
  <span class='label'>plain:</span> <span class='kw'>nil</span><span class='comma'>,</span>

  <span class='comment'># Deprecated. This mapping aimed to be user-friendly, but only caused
</span>  <span class='comment'># confusion. Better to pass through the actual `Net::LDAP` encryption type.
</span>  <span class='label'>ssl:</span> <span class='symbol'>:simple_tls</span><span class='comma'>,</span>
  <span class='label'>tls:</span> <span class='symbol'>:start_tls</span><span class='comma'>,</span>
<span class='rbrace'>}</span></pre></dd>
      
    </dl>
  




  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#auth-instance_method" title="#auth (instance method)">#<strong>auth</strong>  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The final auth structure used by net-ldap.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#base-instance_method" title="#base (instance method)">#<strong>base</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The base DN for searches.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#bind_dn-instance_method" title="#bind_dn (instance method)">#<strong>bind_dn</strong>  &#x21d2; String<sup>?</sup> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The distinguished name used for binding when provided in configuration.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#connection-instance_method" title="#connection (instance method)">#<strong>connection</strong>  &#x21d2; Net::LDAP </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The underlying Net::LDAP connection object.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#filter-instance_method" title="#filter (instance method)">#<strong>filter</strong>  &#x21d2; String<sup>?</sup> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Custom filter pattern when provided in configuration.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#last_operation_result-instance_method" title="#last_operation_result (instance method)">#<strong>last_operation_result</strong>  &#x21d2; Object<sup>?</sup> </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Last operation result object returned by the ldap library (if any).</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#last_password_policy_response-instance_method" title="#last_password_policy_response (instance method)">#<strong>last_password_policy_response</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Read-only attributes exposing connection and configuration state.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#password-instance_method" title="#password (instance method)">#<strong>password</strong>  &#x21d2; String<sup>?</sup> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The bind password (may be nil for anonymous binds).</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#password_policy-instance_method" title="#password_policy (instance method)">#<strong>password_policy</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Whether to request LDAP Password Policy controls.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#uid-instance_method" title="#uid (instance method)">#<strong>uid</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The user id attribute used for lookups (e.g., ‘sAMAccountName’).</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#validate-class_method" title="validate (class method)">.<strong>validate</strong>(configuration = {})  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Validate that a minimal configuration is present.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#bind_as-instance_method" title="#bind_as (instance method)">#<strong>bind_as</strong>(args = {})  &#x21d2; Net::LDAP::Entry, ... </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>:base =&gt; “dc=yourcompany, dc=com”, :filter =&gt; “(mail=#user)”, :password =&gt; psw.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(configuration = {})  &#x21d2; OmniAuth::LDAP::Adaptor </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Create a new adaptor instance backed by a Net::LDAP connection.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(configuration = {})  &#x21d2; <tt><span class='object_link'><a href="" title="OmniAuth::LDAP::Adaptor (class)">OmniAuth::LDAP::Adaptor</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Create a new adaptor instance backed by a Net::LDAP connection.</p>

<p>The constructor does not immediately open a network connection but<br />
prepares the Net::LDAP instance according to the provided configuration.<br />
It also applies timeout settings where supported by the installed net-ldap version.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>configuration</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>user-provided configuration options</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>, <tt><span class='object_link'><a href="Adaptor/ConfigurationError.html" title="OmniAuth::LDAP::Adaptor::ConfigurationError (class)">ConfigurationError</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>on invalid configuration</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/omniauth-ldap/adaptor.rb', line 155</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_configuration'>configuration</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="" title="OmniAuth::LDAP::Adaptor (class)">Adaptor</a></span></span><span class='period'>.</span><span class='id identifier rubyid_validate'><span class='object_link'><a href="#validate-class_method" title="OmniAuth::LDAP::Adaptor.validate (method)">validate</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_configuration'>configuration</span><span class='rparen'>)</span>
  <span class='ivar'>@configuration</span> <span class='op'>=</span> <span class='id identifier rubyid_configuration'>configuration</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
  <span class='ivar'>@configuration</span><span class='lbracket'>[</span><span class='symbol'>:allow_anonymous</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='kw'>false</span>
  <span class='ivar'>@logger</span> <span class='op'>=</span> <span class='ivar'>@configuration</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='symbol'>:logger</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="#VALID_ADAPTER_CONFIGURATION_KEYS-constant" title="OmniAuth::LDAP::Adaptor::VALID_ADAPTER_CONFIGURATION_KEYS (constant)">VALID_ADAPTER_CONFIGURATION_KEYS</a></span></span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='op'>|</span>
    <span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='ivar'>@configuration</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_config'>config</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>base:</span> <span class='ivar'>@base</span><span class='comma'>,</span>
    <span class='label'>hosts:</span> <span class='ivar'>@hosts</span><span class='comma'>,</span>
    <span class='label'>host:</span> <span class='ivar'>@host</span><span class='comma'>,</span>
    <span class='label'>port:</span> <span class='ivar'>@port</span><span class='comma'>,</span>
    <span class='label'>encryption:</span> <span class='id identifier rubyid_encryption_options'>encryption_options</span><span class='comma'>,</span>
  <span class='rbrace'>}</span>
  <span class='comment'># Remove passing timeouts here to avoid issues on older net-ldap versions.
</span>  <span class='comment'># We&#39;ll set them after initialization if the connection responds to writers.
</span>  <span class='ivar'>@bind_method</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='ivar'>@try_sasl</span>
    <span class='symbol'>:sasl</span>
  <span class='kw'>else</span>
    <span class='lparen'>(</span><span class='lparen'>(</span><span class='ivar'>@allow_anonymous</span> <span class='op'>||</span> <span class='op'>!</span><span class='ivar'>@bind_dn</span> <span class='op'>||</span> <span class='op'>!</span><span class='ivar'>@password</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='symbol'>:anonymous</span> <span class='op'>:</span> <span class='symbol'>:simple</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='ivar'>@auth</span> <span class='op'>=</span> <span class='id identifier rubyid_sasl_auths'>sasl_auths</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='label'>username:</span> <span class='ivar'>@bind_dn</span><span class='comma'>,</span> <span class='label'>password:</span> <span class='ivar'>@password</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='kw'>if</span> <span class='ivar'>@bind_method</span> <span class='op'>==</span> <span class='symbol'>:sasl</span>
  <span class='ivar'>@auth</span> <span class='op'>||=</span> <span class='lbrace'>{</span>
    <span class='label'>method:</span> <span class='ivar'>@bind_method</span><span class='comma'>,</span>
    <span class='label'>username:</span> <span class='ivar'>@bind_dn</span><span class='comma'>,</span>
    <span class='label'>password:</span> <span class='ivar'>@password</span><span class='comma'>,</span>
  <span class='rbrace'>}</span>
  <span class='id identifier rubyid_config'>config</span><span class='lbracket'>[</span><span class='symbol'>:auth</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@auth</span>
  <span class='ivar'>@connection</span> <span class='op'>=</span> <span class='const'>Net</span><span class='op'>::</span><span class='const'>LDAP</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_config'>config</span><span class='rparen'>)</span>
  <span class='comment'># Apply optional timeout settings if supported by the installed net-ldap version
</span>  <span class='kw'>if</span> <span class='op'>!</span><span class='ivar'>@connect_timeout</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='kw'>if</span> <span class='ivar'>@connection</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:connect_timeout=</span><span class='rparen'>)</span>
      <span class='ivar'>@connection</span><span class='period'>.</span><span class='id identifier rubyid_connect_timeout'>connect_timeout</span> <span class='op'>=</span> <span class='ivar'>@connect_timeout</span>
    <span class='kw'>else</span>
      <span class='ivar'>@connection</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span><span class='lparen'>(</span><span class='symbol'>:@connect_timeout</span><span class='comma'>,</span> <span class='ivar'>@connect_timeout</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='op'>!</span><span class='ivar'>@read_timeout</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='kw'>if</span> <span class='ivar'>@connection</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:read_timeout=</span><span class='rparen'>)</span>
      <span class='ivar'>@connection</span><span class='period'>.</span><span class='id identifier rubyid_read_timeout'>read_timeout</span> <span class='op'>=</span> <span class='ivar'>@read_timeout</span>
    <span class='kw'>else</span>
      <span class='ivar'>@connection</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span><span class='lparen'>(</span><span class='symbol'>:@read_timeout</span><span class='comma'>,</span> <span class='ivar'>@read_timeout</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="auth-instance_method">
  
    #<strong>auth</strong>  &#x21d2; <tt>Hash</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>The final auth structure used by net-ldap.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


126</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/omniauth-ldap/adaptor.rb', line 126</span>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:connection</span><span class='comma'>,</span> <span class='symbol'>:uid</span><span class='comma'>,</span> <span class='symbol'>:base</span><span class='comma'>,</span> <span class='symbol'>:auth</span><span class='comma'>,</span> <span class='symbol'>:filter</span><span class='comma'>,</span> <span class='symbol'>:password_policy</span><span class='comma'>,</span> <span class='symbol'>:last_operation_result</span><span class='comma'>,</span> <span class='symbol'>:last_password_policy_response</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="base-instance_method">
  
    #<strong>base</strong>  &#x21d2; <tt>String</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>The base DN for searches.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


126</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/omniauth-ldap/adaptor.rb', line 126</span>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:connection</span><span class='comma'>,</span> <span class='symbol'>:uid</span><span class='comma'>,</span> <span class='symbol'>:base</span><span class='comma'>,</span> <span class='symbol'>:auth</span><span class='comma'>,</span> <span class='symbol'>:filter</span><span class='comma'>,</span> <span class='symbol'>:password_policy</span><span class='comma'>,</span> <span class='symbol'>:last_operation_result</span><span class='comma'>,</span> <span class='symbol'>:last_password_policy_response</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="bind_dn=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="bind_dn-instance_method">
  
    #<strong>bind_dn</strong>  &#x21d2; <tt>String</tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>The distinguished name used for binding when provided in configuration.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>, <tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


99
100
101</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/omniauth-ldap/adaptor.rb', line 99</span>

<span class='kw'>def</span> <span class='id identifier rubyid_bind_dn'>bind_dn</span>
  <span class='ivar'>@bind_dn</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="connection-instance_method">
  
    #<strong>connection</strong>  &#x21d2; <tt>Net::LDAP</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>The underlying Net::LDAP connection object.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Net::LDAP</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


126
127
128</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/omniauth-ldap/adaptor.rb', line 126</span>

<span class='kw'>def</span> <span class='id identifier rubyid_connection'>connection</span>
  <span class='ivar'>@connection</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="filter-instance_method">
  
    #<strong>filter</strong>  &#x21d2; <tt>String</tt><sup>?</sup>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Custom filter pattern when provided in configuration.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>, <tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


126</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/omniauth-ldap/adaptor.rb', line 126</span>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:connection</span><span class='comma'>,</span> <span class='symbol'>:uid</span><span class='comma'>,</span> <span class='symbol'>:base</span><span class='comma'>,</span> <span class='symbol'>:auth</span><span class='comma'>,</span> <span class='symbol'>:filter</span><span class='comma'>,</span> <span class='symbol'>:password_policy</span><span class='comma'>,</span> <span class='symbol'>:last_operation_result</span><span class='comma'>,</span> <span class='symbol'>:last_password_policy_response</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="last_operation_result-instance_method">
  
    #<strong>last_operation_result</strong>  &#x21d2; <tt>Object</tt><sup>?</sup>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Last operation result object returned by the ldap library (if any)</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>, <tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


126</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/omniauth-ldap/adaptor.rb', line 126</span>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:connection</span><span class='comma'>,</span> <span class='symbol'>:uid</span><span class='comma'>,</span> <span class='symbol'>:base</span><span class='comma'>,</span> <span class='symbol'>:auth</span><span class='comma'>,</span> <span class='symbol'>:filter</span><span class='comma'>,</span> <span class='symbol'>:password_policy</span><span class='comma'>,</span> <span class='symbol'>:last_operation_result</span><span class='comma'>,</span> <span class='symbol'>:last_password_policy_response</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="last_password_policy_response-instance_method">
  
    #<strong>last_password_policy_response</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Read-only attributes exposing connection and configuration state.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


126</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/omniauth-ldap/adaptor.rb', line 126</span>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:connection</span><span class='comma'>,</span> <span class='symbol'>:uid</span><span class='comma'>,</span> <span class='symbol'>:base</span><span class='comma'>,</span> <span class='symbol'>:auth</span><span class='comma'>,</span> <span class='symbol'>:filter</span><span class='comma'>,</span> <span class='symbol'>:password_policy</span><span class='comma'>,</span> <span class='symbol'>:last_operation_result</span><span class='comma'>,</span> <span class='symbol'>:last_password_policy_response</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="password=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="password-instance_method">
  
    #<strong>password</strong>  &#x21d2; <tt>String</tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>The bind password (may be nil for anonymous binds)</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>, <tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


99</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/omniauth-ldap/adaptor.rb', line 99</span>

<span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:bind_dn</span><span class='comma'>,</span> <span class='symbol'>:password</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="password_policy-instance_method">
  
    #<strong>password_policy</strong>  &#x21d2; <tt>Boolean</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Whether to request LDAP Password Policy controls.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


126</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/omniauth-ldap/adaptor.rb', line 126</span>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:connection</span><span class='comma'>,</span> <span class='symbol'>:uid</span><span class='comma'>,</span> <span class='symbol'>:base</span><span class='comma'>,</span> <span class='symbol'>:auth</span><span class='comma'>,</span> <span class='symbol'>:filter</span><span class='comma'>,</span> <span class='symbol'>:password_policy</span><span class='comma'>,</span> <span class='symbol'>:last_operation_result</span><span class='comma'>,</span> <span class='symbol'>:last_password_policy_response</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="uid-instance_method">
  
    #<strong>uid</strong>  &#x21d2; <tt>String</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>The user id attribute used for lookups (e.g., ‘sAMAccountName’)</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


126</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/omniauth-ldap/adaptor.rb', line 126</span>

<span class='id identifier rubyid_attr_reader'>attr_reader</span> <span class='symbol'>:connection</span><span class='comma'>,</span> <span class='symbol'>:uid</span><span class='comma'>,</span> <span class='symbol'>:base</span><span class='comma'>,</span> <span class='symbol'>:auth</span><span class='comma'>,</span> <span class='symbol'>:filter</span><span class='comma'>,</span> <span class='symbol'>:password_policy</span><span class='comma'>,</span> <span class='symbol'>:last_operation_result</span><span class='comma'>,</span> <span class='symbol'>:last_password_policy_response</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="validate-class_method">
  
    .<strong>validate</strong>(configuration = {})  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>Validate that a minimal configuration is present. Raises ArgumentError when required<br />
keys are missing. This is a convenience to provide early feedback to callers.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>configuration</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>configuration hash passed to the adaptor</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>when required keys are missing</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


134
135
136
137
138
139
140
141
142
143
144</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/omniauth-ldap/adaptor.rb', line 134</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_validate'>validate</span><span class='lparen'>(</span><span class='id identifier rubyid_configuration'>configuration</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='const'><span class='object_link'><a href="#MUST_HAVE_KEYS-constant" title="OmniAuth::LDAP::Adaptor::MUST_HAVE_KEYS (constant)">MUST_HAVE_KEYS</a></span></span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_names'>names</span><span class='op'>|</span>
    <span class='id identifier rubyid_names'>names</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_names'>names</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span>
    <span class='id identifier rubyid_missing_keys'>missing_keys</span> <span class='op'>=</span> <span class='id identifier rubyid_names'>names</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='op'>|</span> <span class='id identifier rubyid_configuration'>configuration</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='rbrace'>}</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_missing_keys'>missing_keys</span> <span class='op'>==</span> <span class='id identifier rubyid_names'>names</span>
      <span class='id identifier rubyid_message'>message</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_names'>names</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> or </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>,</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> MUST be provided</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_message'>message</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="bind_as-instance_method">
  
    #<strong>bind_as</strong>(args = {})  &#x21d2; <tt>Net::LDAP::Entry</tt>, ... 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>:base =&gt; “dc=yourcompany, dc=com”,<br />
:filter =&gt; “(mail=#user)”,<br />
:password =&gt; psw</p>

<p>Attempt to locate a user entry and bind as that entry using the supplied<br />
password. Returns the entry on success, or false/nil on failure.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>args</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>search and bind options forwarded to net-ldap’s search</p>
</div>
      
    </li>
  
</ul>

  
    
    
    <p class="tag_title">Options Hash (<tt>args</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:filter</span>
          <span class="type">(<tt>Net::LDAP::Filter</tt>, <tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>LDAP filter to use</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:size</span>
          <span class="type">(<tt>Integer</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>maximum number of results to fetch</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:password</span>
          <span class="type">(<tt>String</tt>, <tt>Proc</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'><p>a password string or callable returning a password</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Net::LDAP::Entry</tt>, <tt>false</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the found entry on successful bind, otherwise false/nil</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Adaptor/ConnectionError.html" title="OmniAuth::LDAP::Adaptor::ConnectionError (class)">ConnectionError</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>if the underlying LDAP search fails</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/omniauth-ldap/adaptor.rb', line 216</span>

<span class='kw'>def</span> <span class='id identifier rubyid_bind_as'>bind_as</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='ivar'>@last_operation_result</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@last_password_policy_response</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@connection</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_me'>me</span><span class='op'>|</span>
    <span class='id identifier rubyid_rs'>rs</span> <span class='op'>=</span> <span class='id identifier rubyid_me'>me</span><span class='period'>.</span><span class='id identifier rubyid_search'>search</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="Adaptor/ConnectionError.html" title="OmniAuth::LDAP::Adaptor::ConnectionError (class)">ConnectionError</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="#initialize-instance_method" title="OmniAuth::LDAP::Adaptor#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>LDAP search operation failed</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_rs'>rs</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_rs'>rs</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_rs'>rs</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
      <span class='id identifier rubyid_dn'>dn</span> <span class='op'>=</span> <span class='id identifier rubyid_rs'>rs</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_dn'>dn</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_dn'>dn</span>
        <span class='id identifier rubyid_password'>password</span> <span class='op'>=</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='symbol'>:password</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_password'>password</span> <span class='op'>=</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span> <span class='kw'>if</span> <span class='id identifier rubyid_password'>password</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:call</span><span class='rparen'>)</span>

        <span class='id identifier rubyid_bind_args'>bind_args</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='ivar'>@bind_method</span> <span class='op'>==</span> <span class='symbol'>:sasl</span>
          <span class='id identifier rubyid_sasl_auths'>sasl_auths</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='label'>username:</span> <span class='id identifier rubyid_dn'>dn</span><span class='comma'>,</span> <span class='label'>password:</span> <span class='id identifier rubyid_password'>password</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
        <span class='kw'>else</span>
          <span class='lbrace'>{</span>
            <span class='label'>method:</span> <span class='symbol'>:simple</span><span class='comma'>,</span>
            <span class='label'>username:</span> <span class='id identifier rubyid_dn'>dn</span><span class='comma'>,</span>
            <span class='label'>password:</span> <span class='id identifier rubyid_password'>password</span><span class='comma'>,</span>
          <span class='rbrace'>}</span>
        <span class='kw'>end</span>

        <span class='comment'># Optionally request LDAP Password Policy control (RFC Draft - de facto standard)
</span>        <span class='kw'>if</span> <span class='ivar'>@password_policy</span>
          <span class='comment'># Always request by OID using a simple hash; avoids depending on gem-specific control classes
</span>          <span class='id identifier rubyid_control'>control</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='label'>oid:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1.3.6.1.4.1.42.2.27.8.5.1</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>criticality:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>value:</span> <span class='kw'>nil</span><span class='rbrace'>}</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_bind_args'>bind_args</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span>
            <span class='id identifier rubyid_bind_args'>bind_args</span> <span class='op'>=</span> <span class='id identifier rubyid_bind_args'>bind_args</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='label'>controls:</span> <span class='lbracket'>[</span><span class='id identifier rubyid_control'>control</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='rparen'>)</span>
          <span class='kw'>else</span>
            <span class='comment'># Some Net::LDAP versions allow passing a block for SASL only; ensure we still can add controls if hash
</span>            <span class='comment'># When not a Hash, we can&#39;t merge; rely on server default behavior.
</span>          <span class='kw'>end</span>
        <span class='kw'>end</span>

        <span class='kw'>begin</span>
          <span class='id identifier rubyid_success'>success</span> <span class='op'>=</span> <span class='id identifier rubyid_bind_args'>bind_args</span> <span class='op'>?</span> <span class='id identifier rubyid_me'>me</span><span class='period'>.</span><span class='id identifier rubyid_bind'>bind</span><span class='lparen'>(</span><span class='id identifier rubyid_bind_args'>bind_args</span><span class='rparen'>)</span> <span class='op'>:</span> <span class='id identifier rubyid_me'>me</span><span class='period'>.</span><span class='id identifier rubyid_bind'>bind</span>
        <span class='kw'>ensure</span>
          <span class='id identifier rubyid_capture_password_policy'>capture_password_policy</span><span class='lparen'>(</span><span class='id identifier rubyid_me'>me</span><span class='rparen'>)</span>
        <span class='kw'>end</span>

        <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_rs'>rs</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='kw'>if</span> <span class='id identifier rubyid_success'>success</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Mon Nov 10 14:34:57 2025 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.37 (ruby-3.4.7).
</div>

    </div>
  </body>
</html>